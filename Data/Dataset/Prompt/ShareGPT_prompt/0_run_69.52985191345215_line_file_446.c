#include <pthread.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

// define the circular buffer size and the uint8_t array length
#define BUFFER_SIZE 10
#define ARRAY_LENGTH 260

// define the circular buffer structure
typedef struct {
    uint8_t buffer[BUFFER_SIZE][ARRAY_LENGTH];
    int head;
    int tail;
    int count;
    pthread_mutex_t lock;
} CircularBuffer;

// initialize the circular buffer
CircularBuffer fifo = { .head = 0, .tail = 0, .count = 0, .lock = PTHREAD_MUTEX_INITIALIZER };

// define the main thread function
void* main_thread(void* arg) {
    while (true) {
        // generate a new uint8_t array
        uint8_t array[ARRAY_LENGTH];
        // fill the array with new data
        // ...
        // add the array to the circular buffer
        pthread_mutex_lock(&fifo.lock);
        while (fifo.count == BUFFER_SIZE) {
            // the buffer is full, wait until the second thread consumes some data
            pthread_mutex_unlock(&fifo.lock);
            sleep(1);
            pthread_mutex_lock(&fifo.lock);
        }
        
